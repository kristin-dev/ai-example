<div class="recommendations-container">
  <h2>Book Recommendations</h2>
    <!-- Loading section - displays only while the api call is being made -->
    @if (isLoading) {
      <div><p class="loading">
        <img src="/Loading_icon2.gif" alt="Loading Icon"> This can take some time to load, in the mean time, have you read anything recently that you can recommend?
      </p></div>
    }

  <!-- Simple input, just a prompt for the AI -->
  <div class="input-section">
    <label>Describe the books you like:</label>
    <textarea
      type="text"
      [(ngModel)]="inputValue"
      placeholder="This demonstration is turned off, please let me know directly if you would like access."
      rows="6"
      cols="50"
      class="text-input"
    ></textarea>

    <!-- If there's no text in the input, disable the button so we don't make the call -->
<!--    <button-->
<!--      (click)="submit()"-->
<!--      [disabled]=" isLoading"-->
<!--      class="recommend-btn">-->
<!--      {{ isLoading ? 'Finding Recommendations...' : 'Get Book Recommendations' }}-->
<!--    </button>-->

  <!-- Results section - only show if there are results and the api call has completed -->
  @if (response || error) {
  <div class="results-section">
    <h3>Your Personalized Recommendations:</h3>

    <!-- If there's an error let us know -->
    @if (error) {
  <div class="error">
    <strong>Error:</strong> {{ error }}
  </div>
  }

  <!-- If we got a response show what came back! -->
  @if (response && !error) {
  <div class="response">

    @if (response.analysis) {
    <div class="section">
      <h4>Reading Profile Analysis :</h4>
      <p>{{ response.analysis }}</p>
            </div>
    }

    @if (response.recommendations) {
    <div class="section recommendations-list">
      <h4>Recommended Books:</h4>
      <div class="book-grid">
        @for (book of response.recommendations; track $index) {
    <div class="book-card">
      <div class="book-number">{{ $index + 1 }}</div>
      <div class="book-details">
        <h5 class="book-title">{{ book.title }}</h5>
        <p class="book-author">by {{ book.author }}</p>
        <p class="book-year">Published: {{ book.publication_year }}</p>
      </div>
    </div>
    }
    </div>
  </div>
    }

    @if (response.reasoning) {
    <div class="section">
      <h4>Why These Books:</h4>
      <p>{{ response.reasoning }}</p>
            </div>
    }
  </div>
  }
  </div>
  }
</div>
