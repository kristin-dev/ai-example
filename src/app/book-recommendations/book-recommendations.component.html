<div class="recommendations-container">
  <h2>Book Recommendations</h2>
  <ng-container *ngIf="isLoading">
    <div><p class="loading">
      <img src="/Loading_icon2.gif"> This can take some time to load, in the mean time let me tell you about some other cool things...
    </p></div>
  </ng-container>

  <div class="input-section">
    <label for="textInput">Describe the books you like:</label>
    <textarea
      id="textInput"
      [(ngModel)]="inputText"
      placeholder="Tell us about books you've enjoyed, genres you like, or specific authors you love..."
      rows="6"
      cols="50"
      class="text-input">
    </textarea>

    <button
      (click)="getRecommendations()"
      [disabled]="!inputText.trim() || isLoading"
      class="recommend-btn">
      {{ isLoading ? 'Finding Recommendations...' : 'Get Book Recommendations' }}
    </button>
  </div>

  <div class="results-section" *ngIf="response || error">
    <h3>Your Personalized Recommendations:</h3>

    <div *ngIf="error" class="error">
      <strong>Error:</strong> {{ error }}
    </div>

    <div *ngIf="response && !error" class="response">
      <div class="section" *ngIf="response?.analysis">
        <h4>ðŸ“š Reading Profile Analysis:</h4>
        <p>{{ response.analysis }}</p>
      </div>

      <div class="section recommendations-list" *ngIf="response?.recommendations && response.recommendations.length > 0">
        <h4>ðŸ“– Recommended Books:</h4>
        <div class="book-grid">
          <div class="book-card" *ngFor="let book of response.recommendations; let i = index">
            <div class="book-number">{{ i + 1 }}</div>
            <div class="book-details">
              <h5 class="book-title">{{ book.title }}</h5>
              <p class="book-author">by {{ book.author }}</p>
              <p class="book-year">Published: {{ book.publication_year }}</p>
            </div>
          </div>
        </div>
      </div>

      <div class="section" *ngIf="response?.reasoning">
        <h4>ðŸŽ¯ Why These Books:</h4>
        <p>{{ response.reasoning }}</p>
      </div>
    </div>
  </div>
</div>
